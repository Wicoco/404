# ğŸ” Stereolabs Link Checker

SystÃ¨me automatisÃ© de vÃ©rification des liens pour le site Stereolabs.com. DÃ©tecte et notifie uniquement les erreurs 404 via Slack.

## ğŸ¯ FonctionnalitÃ©s

- âœ… **RÃ©cupÃ©ration automatique** du sitemap public Stereolabs
- ğŸ§¹ **Ã‰puration intelligente** des variantes linguistiques et mÃ©dias
- ğŸ” **Scan exhaustif** de tous les liens (internes + externes)
- ğŸ¯ **DÃ©tection prÃ©cise** des erreurs 404 avec localisation HTML
- ğŸ“± **Notifications Slack** uniquement en cas d'erreurs 404
- â° **Automatisation quotidienne** via cron Vercel

## ğŸ—ï¸ Architecture

```
api/
â”œâ”€â”€ check-links.js    # Endpoint scan manuel
â”œâ”€â”€ cron.js          # Automation quotidienne (8h UTC)
lib/
â”œâ”€â”€ SitemapFetcher.js   # RÃ©cupÃ©ration sitemap public
â”œâ”€â”€ SitemapCleaner.js   # Ã‰puration langue/docs/images
â”œâ”€â”€ LinkChecker.js     # Scanner principal avec mÃ©tadonnÃ©es
â”œâ”€â”€ LinkExtractor.js   # Extraction liens HTML prÃ©cise
â”œâ”€â”€ SlackNotifier.js   # Notifications 404 uniquement
â””â”€â”€ utils.js          # Utilitaires communs
```

## ğŸš€ Installation

### 1. Cloner et installer
```bash
git clone <repo-url>
cd stereolabs-link-checker
npm install
```

### 2. Configuration environnement
```bash
cp .env.example .env
# Ã‰diter .env avec vos vraies valeurs
```

### 3. Configuration Slack
1. CrÃ©er webhook Slack: https://api.slack.com/messaging/webhooks
2. Ajouter URL dans `SLACK_WEBHOOK_URL`

### 4. DÃ©ploiement Vercel
```bash
npm run deploy
```

## ğŸ“Š Workflow Complet

### Processus Automatique (Quotidien Ã  8h UTC)

1. **ğŸ“¡ RÃ©cupÃ©ration** â†’ `https://www.stereolabs.com/sitemap.xml`
2. **ğŸ§¹ Ã‰puration** â†’ Supprime `/en/`, `/fr/`, `.pdf`, images, etc.
3. **ğŸ” Extraction** â†’ Tous liens de chaque page avec position HTML
4. **âœ… VÃ©rification** â†’ Test HTTP de chaque lien
5. **ğŸ“± Notification** â†’ Slack SI et SEULEMENT SI erreurs 404

### Ã‰puration Sitemap

- ğŸŒ **Langues**: Supprime `/en/`, `/fr/`, `/de/`, etc. â†’ garde version canonique
- ğŸ“„ **Documents**: Exclut `.pdf`, `.doc`, `.xls`, etc.  
- ğŸ–¼ï¸ **MÃ©dias**: Exclut images, vidÃ©os, CSS, JS
- ğŸ”„ **DÃ©duplication**: URLs normalisÃ©es et uniques

### DÃ©tection Links

- ğŸ”— **Elements**: `<a href>`, `<img src>`, `<iframe src>`
- ğŸ“ **Localisation**: NumÃ©ro ligne, contexte HTML, attributs
- âš¡ **Performance**: Concurrent processing, timeouts intelligents
- ğŸ¯ **PrÃ©cision**: Status codes exacts, redirections trackÃ©es

## ğŸ”§ Utilisation

### Interface Manuelle
```
https://your-deployment.vercel.app/api/manual
```

### API Programmatique
```bash
# Scan complet
curl https://your-deployment.vercel.app/api/check-links

# Scan pages spÃ©cifiques
curl -X POST https://your-deployment.vercel.app/api/check-links \
  -H "Content-Type: application/json" \
  -d '{"urls": ["https://www.stereolabs.com/page1", "https://www.stereolabs.com/page2"]}'
```

### Logs Cron
```bash
# Via Vercel CLI
vercel logs --follow
```

## ğŸ“± Notifications Slack

### Format Notification 404
```
ğŸš¨ LIEN(S) CASSÃ‰(S) DÃ‰TECTÃ‰(S) - Stereolabs.com

ğŸ“Š RÃ©sumÃ©:
â€¢ 3 erreurs 404 critiques
â€¢ 45 pages scannÃ©es  
â€¢ 1,247 liens vÃ©rifiÃ©s
â€¢ Temps: 2m 34s

ğŸ”— DÃ©tails erreurs:
âŒ https://stereolabs.com/broken-page
   â””ğŸ“ TrouvÃ© sur: /products/cameras
   â””ğŸ“ Ligne ~45: <a href="/broken-page">Voir dÃ©tails</a>

âŒ https://external-site.com/missing
   â””ğŸ“ TrouvÃ© sur: /partners  
   â””ğŸ“ Ligne ~78: <a href="https://external-site.com/missing">Partenaire</a>

ğŸ”— Interface: https://your-app.vercel.app/api/manual
```

### Pas de Notification Si
- âœ… Aucune erreur 404 dÃ©tectÃ©e
- âš ï¸ Seulement erreurs 5xx, timeouts ou warnings
- ğŸ”„ Redirections (3xx) considÃ©rÃ©es OK
